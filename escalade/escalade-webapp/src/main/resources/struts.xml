<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE struts PUBLIC
        "-//Apache Software Foundation//DTD Struts Configuration 2.5//EN"
        "http://struts.apache.org/dtds/struts-2.5.dtd">
<struts>
	<package name="base" extends="struts-default">

		<!-- Action par défaut -->
		<default-action-ref name="index" />
		
		<!-- Results globaux -->
        <global-results>
            <result name="error">/WEB-INF/jsp/error.jsp</result>
        </global-results>

		<!-- Action "index" -->
		<action name="index">
			<result>/WEB-INF/jsp/index.jsp</result>
		</action>
		
		<!-- Action affichant la page d'info (pas de traitement) -->
		<action name="infos">
			<result>/WEB-INF/jsp/infos.jsp</result>
		</action>

		<!-- Action affichant la page de recherche de spot : chargement de la liste des département et des difficulté pour les listes déroulantes -->
		<action name="spots" class="org.escalade.webapp.action.SpotAction" method="versRecherche">
			<result name="success">/WEB-INF/jsp/spot/spots.jsp</result>
		</action>
		
		<!-- Action affichant la fiche d'un spot -->
		<action name="spotInfo"
			class="org.escalade.webapp.action.SpotAction" method="spotInfo">
			<result name="success">/WEB-INF/jsp/spot/spotInfo.jsp</result>
		</action>
		
		<!-- Action de suppression d'un spot -->
		<action name="supprimerSpot"
			class="org.escalade.webapp.action.SpotAction" method="supprimerSpot">
			<result name="success" type="redirectAction">
				<param name="actionName">supprimer</param>
				<param name="message">${message}</param>
			</result>
		</action>
		
		<action name="supprimer" class="org.escalade.webapp.action.SpotAction" method="message">
			<result>/WEB-INF/jsp/index.jsp</result>
		</action>
		
		<!-- Action de suppression d'un commentaire -->
		<action name="supprimerCommentaire"	class="org.escalade.webapp.action.SpotAction" method="supprimerCommentaire">
			<result name="success" type="redirectAction">
				<param name="actionName">spotInfo</param>
				<param name="spotId">${spotId}</param>
			</result>
		</action>
		
		<!-- Action de chargement de la page de modification d'un spot -->
		<action name="versModifierSpot" class="org.escalade.webapp.action.SpotAction" method="versModifier">
			<result name="success">/WEB-INF/jsp/spot/modifierSpot.jsp</result>
		</action>
		
	</package>
	
    <!-- ===== Package pour les actions AJAX ===== -->

    <package name="ajax" extends="base, json-default">
    
		<!-- Action affichant le résultat de la recherche de spot -->
        <action name="ajax_rechercheSpot" class="org.escalade.webapp.action.SpotAction" method="doAJAXrecherche">
            <result name="success" type="json">
                <param name="root">resultatRecherche</param>
            </result>
        </action>
        
		<!-- Action affichant mettant à jour la liste des villes en fonction du déprtement sélectionné -->
        <action name="ajax_getVilles" class="org.escalade.webapp.action.SpotAction" method="doAJAXgetVilles">
            <result name="success" type="json">
                <param name="root">listVilles</param>
            </result>
        </action>
        
		<!-- Action ajoutant un commantaire et retournant le spot modifié -->
        <action name="ajax_nouveauCommentaire" class="org.escalade.webapp.action.SpotAction" method="doAJAXnouveauCommentaire">
            <result name="success" type="json">
                <param name="root">spot</param>
            </result>
        </action>
    </package>

</struts>